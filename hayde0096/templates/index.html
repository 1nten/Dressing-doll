<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> æ¬¢è¿å›æ¥æï½ </title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <h1> æ¬¢è¿å›æ¥å–µï½ </h1>

    <!-- ğŸ” æœç´¢æ¡† -->
    <input type="text" id="search" placeholder="ğŸ” " onkeyup="filterImages()">

    <!-- ğŸŒŸ ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
    <button class="switch-theme" onclick="toggleTheme()">ğŸŒŸ</button>

    <!-- ğŸ“„ å›¾ç‰‡åˆ—è¡¨ -->
    <div class="container" id="imageContainer">
        {% for item in images %}
        <div class="item">
            <img src="{{ item.image }}" alt="å›¾ç‰‡">
            <p class="copy-text" onclick="copyText(this)">{{ item.text }}</p>
        </div>
        {% endfor %}
    </div>

    <!-- ğŸ“Œ ç¿»é¡µæŒ‰é’® -->
    <div class="pagination">
        <button id="prevPage" onclick="changePage(-1)">Â« ä¸Šä¸€é¡µ</button>
        <span id="pageInfo"></span>
        <button id="nextPage" onclick="changePage(1)">ä¸‹ä¸€é¡µ Â»</button>
    </div>

    <script>
        //  ğŸŒˆ ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        let currentTheme = 'default';

        function toggleTheme() {
            const body = document.body;
            if (currentTheme === 'default') {
                body.classList.add('theme-anime');
                currentTheme = 'anime';
            } else {
                body.classList.remove('theme-anime');
                currentTheme = 'default';
            }
        }

        //  ğŸ“‹ å¤åˆ¶æ–‡æœ¬åŠŸèƒ½
        function copyText(element) {
            const text = element.innerText.trim();
            if (!text) return;

            navigator.clipboard.writeText(text).then(() => {
                console.log("å·²å¤åˆ¶: " + text);
                element.style.background = "var(--button-hover-bg)";
                element.style.color = "white";
                setTimeout(() => {
                    element.style.background = "var(--button-bg)";
                    element.style.color = "var(--button-text)";
                }, 1000);
            }).catch(err => {
                console.error("å¤åˆ¶å¤±è´¥:", err);
            });
        }

        //  ğŸ” æœç´¢åŠŸèƒ½
        function filterImages() {
            let input = document.getElementById("search").value.toLowerCase();
            let items = document.querySelectorAll(".item");

            items.forEach(item => {
                let text = item.querySelector(".copy-text").innerText.toLowerCase();
                if (text.includes(input)) {
                    item.style.display = "block"; // åŒ¹é…æ˜¾ç¤º
                    item.style.opacity = "1";
                } else {
                    item.style.opacity = "0"; // æ¸éšåŠ¨ç”»
                    setTimeout(() => {
                        item.style.display = "none";
                    }, 200);
                }
            });
        }
        // ğŸ” æœç´¢åŠŸèƒ½ - å…³é”®è¯é«˜äº®
        function filterImages() {
            let input = document.getElementById("search").value.trim().toLowerCase();
            let items = document.querySelectorAll(".item");

            items.forEach(item => {
                let textElement = item.querySelector(".copy-text");
                let originalText = textElement.getAttribute("data-original-text") || textElement.innerText;

                if (input) {
                    let regex = new RegExp(`(${input})`, "gi");
                    let highlightedText = originalText.replace(regex, `<span class="highlight">$1</span>`);
                    textElement.innerHTML = highlightedText;
                } else {
                    textElement.innerHTML = originalText;
                }

                if (originalText.toLowerCase().includes(input)) {
                    item.style.display = "block";
                    setTimeout(() => { item.style.opacity = "1"; }, 100);
                } else {
                    item.style.opacity = "0";
                    setTimeout(() => { item.style.display = "none"; }, 200);
                }

                textElement.setAttribute("data-original-text", originalText);
            });
        }
        //  ğŸ“„ ç¿»é¡µåŠŸèƒ½
        let currentPage = 1;
        const itemsPerPage = 50;
        let items = document.querySelectorAll(".item");

        function showPage(page) {
            let start = (page - 1) * itemsPerPage;
            let end = start + itemsPerPage;

            items.forEach((item, index) => {
                if (index >= start && index < end) {
                    item.style.display = "block";
                    setTimeout(() => { item.style.opacity = "1"; }, 100);
                } else {
                    item.style.opacity = "0";
                    setTimeout(() => { item.style.display = "none"; }, 200);
                }
            });

            document.getElementById("pageInfo").innerText = `ç¬¬ ${page} é¡µ / å…± ${Math.ceil(items.length / itemsPerPage)} é¡µ`;
            document.getElementById("prevPage").disabled = page === 1;
            document.getElementById("nextPage").disabled = page === Math.ceil(items.length / itemsPerPage);
        }

        function changePage(step) {
            currentPage += step;
            showPage(currentPage);
        }

        //  åˆå§‹åŒ–ç¬¬ä¸€é¡µ
        showPage(1);
    </script>
</body>

</html>